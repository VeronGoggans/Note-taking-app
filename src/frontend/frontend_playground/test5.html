<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-Scrolling Text Editor</title>
    <style>
        /* Styling the contenteditable div */
        .editor {
            width: 600px;
            height: 300px;
            border: 1px solid #ccc;
            padding: 10px;
            overflow-y: auto; /* Scrollable */
            font-family: Arial, sans-serif;
            font-size: 16px;
            line-height: 1.5;
            white-space: pre-wrap; /* Keep whitespace formatting */
            scroll-behavior: smooth; /* Makes native scroll smooth */
        }
    </style>
</head>
<body>

<div class="editor" contenteditable="true"></div>

<script>
    const editor = document.querySelector('.editor');

    editor.addEventListener('input', () => {
        ensureCursorVisibility();
    });

    editor.addEventListener('keyup', (event) => {
        ensureCursorVisibility();
    });

    function ensureCursorVisibility() {
        const cursorPosition = getCaretCoordinates();
        if (cursorPosition) {
            const { top, bottom } = cursorPosition;
            const editorRect = editor.getBoundingClientRect();

            // Check if the cursor is near or below the visible bottom of the editor
            if (bottom > editorRect.bottom) {
                editor.scrollTo({
                    top: editor.scrollTop + (bottom - editorRect.bottom) + 100, // Calculate the amount to scroll
                    behavior: 'smooth' // Enable smooth scrolling
                });
            }
        }
    }

    // Function to get the coordinates of the text cursor
    function getCaretCoordinates() {
        const selection = window.getSelection();
        if (selection.rangeCount === 0) return null;
        const range = selection.getRangeAt(0).cloneRange();

        const tempSpan = document.createElement('span');
        range.collapse(false); // Collapse to the end of the range
        range.insertNode(tempSpan);

        const rect = tempSpan.getBoundingClientRect();
        const coordinates = { top: rect.top, bottom: rect.bottom };

        tempSpan.parentNode.removeChild(tempSpan); // Clean up the temporary span

        return coordinates;
    }
</script>

</body>
</html>
