<h1 style="text-align: center;">Websecurity</h1><div style="text-align: center;">Waar moeten we op letten by websecurity</div><div style="text-align: center;"><img src="https://ci453.tw466.brighton.domains/wp-content/uploads/2021/05/ciatriad.png" alt="The CIA Triad: Confidentiality, Integrity, Availability, 48% OFF"><br></div><div><span style="font-weight: bold;">Confidentiality (vertrouwbaarheid)</span></div><div>Data, objecten en resources zijn beschermed tegen&nbsp;</div><div>ongeautoriseerde toegang.</div><div><br></div><div><span style="font-weight: bold;">Integrety (integriteit)</span></div><div>Data is beschermd tegen ongeautoriseerde wijzigingen om zo&nbsp;</div><div>de intergiteit te waarborgen.&nbsp;</div><div><br></div><div><span style="font-weight: bold;">Availability (beschikbaarheid)</span></div><div>Geautoriseerde gebruikers moeten toegang hebben tot de systemen en resources&nbsp;</div><div>die zij nodig hebben.&nbsp;</div><div><br></div><div><span style="font-weight: bold;">Vulnerability</span></div><div>Een kwetsbaarheid waarmee een bepaald risico wordt bloodgesteld.&nbsp;</div><div><br></div><div><span style="font-weight: bold;">Exploit</span></div><div>Een methode waarmee misbruik wordt gemaakt van een kwetsbaarheid.</div><div><br></div><div><span style="font-weight: bold;">Attack vector</span></div><div>Aanvalsmethode waarmee een aanval uigevoerd kan worden.&nbsp;</div><div><br></div><div><span style="font-weight: bold;">Attack surface</span></div><div>Het bloodgestelde oopervlak waar aanvallers misbruik van zouden&nbsp;</div><div>kunnen maken.&nbsp;</div><div><br></div><div><span style="font-weight: bold;">OWASP</span></div><div>OWASP draait om awareness en geeft zoveel mogelijk&nbsp;</div><div>handvatten &amp; best practices voor de mitigation van security vulnerabilities.</div><div><br></div><h2>OWASP top 10&nbsp;</h2><div><ol><li>Injection</li><li>Broken authentication</li><li>Sensitive data exposure</li><li>XML external entities&nbsp;</li><li>Broken access control&nbsp;</li><li>Security misconfiguration&nbsp;</li><li>Cross site scripting (XSS)</li><li>Insecure deserialization</li><li>Using components with known vulnerabilities&nbsp;</li><li>Insufficient logging &amp; monitoring&nbsp;</li></ol><div><br></div><h3>Injection</h3><div>Scenario 1&nbsp;</div><div>Untrusted data in SQL&nbsp;</div><div><br></div><div>Scenario 2&nbsp;</div><div>Untrusted data in framework or library</div><div><br></div><div><span style="font-weight: bold;">Kwetsbaar</span></div></div><div><ul><li>Geen validatie, filtering of sanitisatie van gebruikersinput</li><li>Rechtstreeks gebruik invoer in interpreter zonder escaping of parameterisatie</li><li>Gebruik kwaadwillende data in ORM parameters om gevoelige data te verkrijgen</li></ul><div><span style="font-weight: bold;">Maatregelen</span></div></div><div><ul><li>Stuur zo min mogelijk user input naar een interpreter of storage runtime</li><li>Laat user input alleen toe via parameterisatie</li><li>Gebruik whitelisting voor toegestanen input&nbsp;</li><li>escape special characters</li></ul><div><br></div></div><h3>Broken authentication</h3><div>Scenario 1 (credential stuffing)</div><div>Gebruik van een lijst van bekende usernames/passwords om op grote&nbsp;</div><div>schaal geautomatiseerd in te loggen.&nbsp;</div><div><br></div><div>Scenario 2 (single factor)</div><div>Passwords als enige factor ter authenticatie en slechte&nbsp;</div><div>password rotatie en complexiteid&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">strategien.</span></div><div><br></div><div>Scenario 3 (poor session management)</div><div>Geen of te lange session timeouts&nbsp;</div><div><br></div><div><span style="font-weight: 700;">Kwetsbaar</span><br></div><div><ul><li>credential stuffing of dictionary attack is mogelijk en word niet afgeremd</li><li>Brute force is mogelijk en wordt niet afgeremd</li><li>Standaard/zwakke/bekende wachtwoorden worden toegelaten.&nbsp;</li><li>Zwakke passwords recovery mechanismes</li><li>Plain text, encrypted of zwak gehashede wachtwoorden.</li><li>Geen session id rotatie na log in&nbsp;</li><li>Geen session id invalidatie bij log uit&nbsp;</li><li>Te lange session timeout of expiration&nbsp;</li></ul><div><span style="font-weight: bold;">Maatregelen</span></div></div><div><ul><li>Multi-factor authentication (MFA)</li><li>Geen default credentials instellen</li><li>Check tegen zwakke en bekende wachtwoorden</li><li>Check wachtwoordcomplexiteit en stel logisch wachtwoordbeleid in</li><li>Gebruik de juiste APIs voor o.a. hashing en password checks</li><li>Voorkom dat gebruikersaccounts geraden kunnen worden</li><li>standaardiseer HTTP status codes bij login en registratie</li><li>Beperk of vertraag login-pogingen</li><li>Check/log verdachte loginpogingen en meld deze</li><li>Gebruik random session ids die niet makkelijk te raden zijn</li><li>Toon session Ids niet in de URL</li><li>Sla sessions veilig op en invalidate ze na login, onbruik en verloop&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">van tijd</span></li></ul><div><br></div><h3><span style="background-color: var(--background); color: var(--editor-text);">Sensitive data exposure</span></h3></div><div><span style="background-color: var(--background); color: var(--editor-text);">Scenario 1 (afhankelijkheid auto-encryptie)</span></div><div><span style="background-color: var(--background); color: var(--editor-text);">SQL injection kan leiden tot uitlekken van credit card gegevens</span></div><div><span style="background-color: var(--background); color: var(--editor-text);"><br></span></div><div><span style="background-color: var(--background); color: var(--editor-text);">Scenario 2 (man in the middle)</span></div><div><span style="background-color: var(--background);"><div style="">Site gebruikt niet of nauwelijks TLS of gebruikt zwakke encryptie. Aanvaller houdt</div><div style="">netwerkverkeer in de gaten en zend verbindingen door naar HTTP in plaats van HTTPS,</div><div style="">onderschept requests en steelt session cookies van gebruikers of verandert de acties</div><div style="">die worden uitgevoerd.</div><div style=""><br></div><div style="">Aanvaller kan met session cookie de sessie bemachtigen en zo priv√©gegevens zien en</div><div style="">wijzigen.</div><div style=""><br></div><div style="">Scenario 3 (<span style="background-color: var(--background); color: var(--editor-text);">plain-text of zwak gehashte wachtwoorden</span><span style="background-color: var(--background); color: var(--editor-text);">)</span></div><div style=""><span style="background-color: var(--background);"><div style="color: var(--editor-text);">Wachtwoorden zijn opgeslagen in leesbare tekst-vorm, zonder salt of als basale hash.</div><div style="color: var(--editor-text);">Een aanvaller weet toegang tot de wachtwoorden te krijgen.</div><div style="color: var(--editor-text);">Aanvaller kan plain-text wachtwoorden gewoon lezen, unsalted hashes kraken met</div><div style="color: var(--editor-text);">een rainbow table of voorberekening en zwakke hashes kraken met een GPU.</div><div style="color: var(--editor-text);"><br></div><div style="color: var(--editor-text);"><span style="font-weight: bold;">Kwetsbaar</span></div><div style="color: var(--editor-text);">Voor zover het gaat om gevoelige data.&nbsp;</div><div style=""><ul style="color: var(--editor-text);"><li>Plain text word gebruikt zonder enige encryptie</li><li>Er wordt oude of verslechterde cryptografische algoritmes gebruikt</li><li>Er worden crypto-keys gebruikt of gegenereerd die standard&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">zijn of hergebruikt worden en er is geen rotation scheme</span></li><li><span style="background-color: var(--background); color: var(--editor-text);">Encryptie wordt niet afgedwongen en andere browser&nbsp;<span style="color: var(--editor-text); background-color: var(--background);">security maatregelen worden niet gehanteerd</span></span></li><li><span style="background-color: var(--background); color: var(--editor-text);"><span style="color: var(--editor-text); background-color: var(--background);">User agent (browser, app, mail client) verifeert geldigheid&nbsp;<span style="color: var(--editor-text); background-color: var(--background);">certificaat niet</span><br></span></span></li></ul><div><span style="font-weight: bold;">Maatregelen</span></div><div><div style=""><ul><li>Breng in kaart welke gevoelige gegevens er worden verwerkt en pas&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">daar passende bescherming op toe (zie GDPR en PCI Data Security&nbsp;</span>Standard)</li><li>Sla gevoelige data alleen op als je het nodig hebt en voor zolang je&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">het nodig hebt</span></li><li>Encrypt alle gevoelige gegevens die je opslaat</li><li>Gebruik up-to-date en sterke, bewezen algoritmes en protocollen en&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">gebruik goede key management</span></li><li>Encrypt al het gegevensverkeer met veilige protocollen zoals TLS&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">met veilig standaarden</span></li><li>Gebruik HSTS directives (HTTP Strict Transport Security)</li><li>Cache en log responses met gevoelige data niet</li><li>Sla wachtwoorden op met sterke, adaptive en salted hashing&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">functions met een delay factor (Argon2, scrypt, bcrypt of PBKDF2)</span></li></ul><div><br></div></div></div><div style=""><h3 style="">XML external entities</h3><div style="">Scenario 1&nbsp;</div><div style="">Attacker leest data van de server&nbsp;</div><div style=""><br></div><div style="">Scenario 2&nbsp;</div><div style="">Attacker checkt private netwerk van de server&nbsp;</div><div style=""><br></div><div style="">Scenario 3&nbsp;</div><div style="">Attacker probeerd een denial of service attack&nbsp;</div><div style="">middels een oneindig groot bestand</div><div style=""><br></div><div style=""><span style="font-weight: bold;">Kwetsbaar</span>&nbsp;</div><div style=""><div><ul><li>Applicatie accepteert (untrusted) XML content, XML&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">uploads of voegt (untrusted) content toe aan XML dat dan&nbsp;</span><span style="background-color: var(--background); color: var(--editor-text);">wordt verwerkt door een XML processor</span></li><li>XML processors en SOAP web services gebruiken DTDs om&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">XMLs ver verwerken en te valideren en kan daarvoor&nbsp;</span><span style="background-color: var(--background); color: var(--editor-text);">externe bronnen gebruiken</span></li><li>Ouder versies van SOAP (&lt; 1.2) zijn waarschijnlijk&nbsp;<span style="background-color: var(--background); color: var(--editor-text);">kwetsbaar als XML entities worden doorgegeven aan het&nbsp;</span><span style="background-color: var(--background); color: var(--editor-text);">SOAP framework</span></li></ul><div><span style="font-weight: bold;">Maatregelen</span></div></div></div></div></div><div style="color: var(--editor-text);"><div style="color: var(--editor-text);"><ul><li>Geen XML (processors) gebruiken</li><li>XML processors en SOAP libraries updaten</li><li>Dependency checkers gebruiken om up-to-date te blijven</li><li>Zet XML external entities en DTD processing uit in XML parsers /&nbsp;<span style="color: var(--editor-text); background-color: var(--background);">processors</span></li><li>Gebruik whitelisting input validation, filtering, sanitization om te&nbsp;<span style="color: var(--editor-text); background-color: var(--background);">voorkomen dat kwaadwillende data terecht komt in XML content</span></li><li>Valideer XML en XSL</li><li>Gebruik virtual patching, API security gateways of Web Application</li><li>Firewalls om XXE te detecteren, monitoren en blokkeren</li></ul><div><br></div></div></div></span></div></span></div>