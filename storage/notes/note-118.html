<div style="color: rgb(212, 212, 212); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px; white-space: pre;"><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- ------------------------------------------------------------------------</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Data &amp; Persistency</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Opdracht S3: Multiple Tables</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">--</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- (c) 2020 Hogeschool Utrecht</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Tijmen Muller (tijmen.muller@hu.nl)</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- André Donk (andre.donk@hu.nl)</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">--</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">--</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Opdracht: schrijf SQL-queries om onderstaande resultaten op te vragen,</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- aan te maken, verwijderen of aan te passen in de database van de</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- bedrijfscasus.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">--</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Codeer je uitwerking onder de regel 'DROP VIEW ...' (bij een SELECT)</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- of boven de regel 'ON CONFLICT DO NOTHING;' (bij een INSERT)</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Je kunt deze eigen query selecteren en los uitvoeren, en wijzigen tot</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- je tevreden bent.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">--</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Vervolgens kun je je uitwerkingen testen door de testregels</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- (met [TEST] erachter) te activeren (haal hiervoor de commentaartekens</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- weg) en vervolgens het hele bestand uit te voeren. Hiervoor moet je de</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- testsuite in de database hebben geladen (bedrijf_postgresql_test.sql).</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- NB: niet alle opdrachten hebben testregels.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">--</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Lever je werk pas in op Canvas als alle tests slagen.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- ------------------------------------------------------------------------</span></div><span style="background-color: rgb(255, 255, 255);"><br><br></span><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- S3.1.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Produceer een overzicht van alle cursusuitvoeringen; geef de</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- code, de begindatum, de lengte en de naam van de docent.</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: rgb(86, 156, 214);">DROP</span> <span style="color: rgb(86, 156, 214);">VIEW</span> <span style="color: rgb(86, 156, 214);">IF</span> <span style="color: rgb(86, 156, 214);">EXISTS</span> s3_1; <span style="color: rgb(86, 156, 214);">CREATE</span> <span style="color: rgb(86, 156, 214);">OR</span> <span style="color: rgb(86, 156, 214);">REPLACE</span> VIEW s3_1 <span style="color: rgb(86, 156, 214);">AS</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="background-color: rgb(255, 255, 255); color: rgb(106, 153, 85);">-- [TEST]</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> </span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; u.cursus,</span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; u.begindatum,</span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; cu.lengte,</span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; me.naam</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">FROM</span> uitvoeringen u</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">JOIN</span> cursussen cu</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">ON</span> u.cursus = cu.code</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">JOIN</span> medewerkers me</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">ON</span> u.docent = me.mnr;</span></div><span style="background-color: rgb(255, 255, 255);"><br><br></span><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- S3.2.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Geef in twee kolommen naast elkaar de achternaam van elke cursist (`cursist`)</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- van alle S02-cursussen, met de achternaam van zijn cursusdocent (`docent`).</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- DROP VIEW IF EXISTS s3_2; CREATE OR REPLACE VIEW s3_2 AS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -- [TEST]</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- SELECT </span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- &nbsp;me.naam,</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- &nbsp;me.naam</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- FROM medewerkers me</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- JOIN inschrijvingen i</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- ON me.mnr = i.cursist AND i.cursus = 'S02'</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- JOIN uitvoeringen u</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- ON me.mnr = u.docent AND u.cursus = 'S02';</span></div><span style="background-color: rgb(255, 255, 255);"><br><br></span><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- S3.3.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Geef elke afdeling (`afdeling`) met de naam van het hoofd van die</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- afdeling (`hoofd`).</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">DROP</span> <span style="color: #569cd6;">VIEW</span> <span style="color: #569cd6;">IF</span> <span style="color: #569cd6;">EXISTS</span> s3_3; <span style="color: #569cd6;">CREATE</span> <span style="color: #569cd6;">OR</span> <span style="color: #569cd6;">REPLACE</span> VIEW s3_3 <span style="color: #569cd6;">AS</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #6a9955;">-- [TEST]</span></span></div><div style=""><span style="color: rgb(86, 156, 214); background-color: rgb(255, 255, 255);">SELECT</span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; afdelingen.naam <span style="color: #569cd6;">as</span> <span style="color: #ce9178;">"afdeling"</span>,</span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; medewerkers.naam <span style="color: #569cd6;">as</span> <span style="color: #ce9178;">"hoofd"</span></span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">FROM</span> afdelingen</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">JOIN</span> medewerkers </span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">ON</span> afdelingen.hoofd = medewerkers.mnr;</span></div><span style="background-color: rgb(255, 255, 255);"><br></span><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- S3.4.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Geef de namen van alle medewerkers, de naam van hun afdeling (`afdeling`)</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- en de bijbehorende locatie.</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">DROP</span> <span style="color: #569cd6;">VIEW</span> <span style="color: #569cd6;">IF</span> <span style="color: #569cd6;">EXISTS</span> s3_4; <span style="color: #569cd6;">CREATE</span> <span style="color: #569cd6;">OR</span> <span style="color: #569cd6;">REPLACE</span> VIEW s3_4 <span style="color: #569cd6;">AS</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #6a9955;">-- [TEST]</span></span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> </span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; medewerkers.naam,</span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; afdelingen.naam,</span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; afdelingen.locatie</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">FROM</span> medewerkers</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">JOIN</span> afdelingen</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">ON</span> medewerkers.afd = afdelingen.anr;</span></div><span style="background-color: rgb(255, 255, 255);"><br></span><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- S3.5.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Geef de namen van alle cursisten die staan ingeschreven voor de cursus S02 van 12 april 2019</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">DROP</span> <span style="color: #569cd6;">VIEW</span> <span style="color: #569cd6;">IF</span> <span style="color: #569cd6;">EXISTS</span> s3_5; <span style="color: #569cd6;">CREATE</span> <span style="color: #569cd6;">OR</span> <span style="color: #569cd6;">REPLACE</span> VIEW s3_5 <span style="color: #569cd6;">AS</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #6a9955;">-- [TEST]</span></span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> </span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; me.naam</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">FROM</span> medewerkers me</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">JOIN</span> inschrijvingen i</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">ON</span> me.mnr = i.cursist</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">WHERE</span> (i.cursus = <span style="color: #ce9178;">'S02'</span>)</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">AND</span> (i.begindatum = <span style="color: #ce9178;">'2019-04-12'</span>);</span></div><span style="background-color: rgb(255, 255, 255);"><br><br></span><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- S3.6.</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Geef de namen van alle medewerkers en hun toelage.</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">DROP</span> <span style="color: #569cd6;">VIEW</span> <span style="color: #569cd6;">IF</span> <span style="color: #569cd6;">EXISTS</span> s3_6; <span style="color: #569cd6;">CREATE</span> <span style="color: #569cd6;">OR</span> <span style="color: #569cd6;">REPLACE</span> VIEW s3_6 <span style="color: #569cd6;">AS</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #6a9955;">-- [TEST]</span></span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> </span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; me.naam,</span></div><div style=""><span style="background-color: rgb(255, 255, 255);">&nbsp; &nbsp; s.toelage</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">FROM</span> medewerkers me</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">JOIN</span> schalen s</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">ON</span> me.maandsal <span style="color: #569cd6;">BETWEEN</span> s.ondergrens <span style="color: #569cd6;">AND</span> s.bovengrens;</span></div><span style="background-color: rgb(255, 255, 255);"><br></span><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- -------------------------[ HU TESTRAAMWERK ]--------------------------------</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- Met onderstaande query kun je je code testen. Zie bovenaan dit bestand</span></div><div style=""><span style="color: rgb(106, 153, 85); background-color: rgb(255, 255, 255);">-- voor uitleg.</span></div><span style="background-color: rgb(255, 255, 255);"><br></span><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> * <span style="color: #569cd6;">FROM</span> test_select(<span style="color: #ce9178;">'S3.1'</span>) <span style="color: #569cd6;">AS</span> resultaat</span></div><div style=""><span style="color: rgb(86, 156, 214); background-color: rgb(255, 255, 255);">UNION</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> * <span style="color: #569cd6;">FROM</span> test_select(<span style="color: #ce9178;">'S3.2'</span>) <span style="color: #569cd6;">AS</span> resultaat</span></div><div style=""><span style="color: rgb(86, 156, 214); background-color: rgb(255, 255, 255);">UNION</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> * <span style="color: #569cd6;">FROM</span> test_select(<span style="color: #ce9178;">'S3.3'</span>) <span style="color: #569cd6;">AS</span> resultaat</span></div><div style=""><span style="color: rgb(86, 156, 214); background-color: rgb(255, 255, 255);">UNION</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> * <span style="color: #569cd6;">FROM</span> test_select(<span style="color: #ce9178;">'S3.4'</span>) <span style="color: #569cd6;">AS</span> resultaat</span></div><div style=""><span style="color: rgb(86, 156, 214); background-color: rgb(255, 255, 255);">UNION</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> * <span style="color: #569cd6;">FROM</span> test_select(<span style="color: #ce9178;">'S3.5'</span>) <span style="color: #569cd6;">AS</span> resultaat</span></div><div style=""><span style="color: rgb(86, 156, 214); background-color: rgb(255, 255, 255);">UNION</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: #569cd6;">SELECT</span> * <span style="color: #569cd6;">FROM</span> test_select(<span style="color: #ce9178;">'S3.6'</span>) <span style="color: #569cd6;">AS</span> resultaat</span></div><div style=""><span style="background-color: rgb(255, 255, 255);"><span style="color: rgb(86, 156, 214);">ORDER BY</span> resultaat;</span></div></div>